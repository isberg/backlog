
box: node:7.2.0
build:
  steps:
    - script:
        name: install elm globally
        code: |
          npm install -g elm@0.18.0

    - script:
        name: debug elm
        code: |
          elm-make -h

    - script:
        name: elm-make
        code: |
          elm-make --yes Main.elm --output=index.html
          
# http://devcenter.wercker.com/docs/workflows
deploy:
  box:
    id: nginx:alpine

  steps:
    - script:
        name: copy files to nginx
        code: |
          cp /pipeline/source/index.html /usr/share/nginx/html
    - script:
        name: cleanup build result
        code: |
          rm -rf /pipeline
      
    # push container as-is
    - internal/docker-push:
        disable-sync: true
        username: $USERNAME
        password: $PASSWORD
        port: 8000
        tag: latest, $WERCKER_GIT_COMMIT, $WERCKER_GIT_BRANCH
        repository: isberg/backlog        
